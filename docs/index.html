<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>JS 解密 · 网页端</title>
  <style>
    /* 基础排版（移动优先） */
    :root{
      --gap:12px;
      --radius:14px;
      --pad:12px;
      --bg:#ffffff;
      --fg:#111;
      --muted:#666;
      --ok:#0a0;
      --err:#c00;
      --card:#f6f7f8;
      --codebg:#0c0c0c;
      --codefg:#cde9c7;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b0c0f; --fg:#e9ecf1; --muted:#98a0ab;
        --card:#151821; --codebg:#0f1115; --codefg:#c6f3c0;
      }
    }
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      -webkit-text-size-adjust:100%;
      padding: calc(var(--pad) + env(safe-area-inset-top)) var(--pad) calc(80px + env(safe-area-inset-bottom));
      max-width: 880px;
      margin-inline: auto;
    }
    h1{font-size: clamp(20px, 5.8vw, 32px); margin: 4px 0 12px}
    p{margin:8px 0}
    label{display:block; margin-top:10px; font-weight:600; font-size:14px}
    input, button, textarea{
      width:100%; padding:14px; margin-top:6px; font-size:16px; border-radius: var(--radius);
      border:1px solid #d0d5dd; background:var(--bg); color:var(--fg);
      -webkit-appearance:none; outline:none;
    }
    input:focus, textarea:focus{ box-shadow: 0 0 0 3px rgba(84,132,255,.25); border-color:#7aa2ff }
    textarea{
      min-height: 60vh; /* 首屏就能看到大面积输入框 */
      resize: none;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Liberation Mono", Consolas, monospace;
      line-height: 1.35;
      background: var(--card);
      overflow-wrap: anywhere;
      white-space: pre-wrap;
    }
    .muted{color:var(--muted)}
    .ok{color:var(--ok)} .err{color:var(--err)}
    .grid{
      display:grid; gap:var(--gap);
      grid-template-columns: 1fr;
    }
    @media (min-width: 720px){
      .grid-2{ grid-template-columns: 2fr 1fr; }
    }
    .actions.sticky{
      position: fixed; left:0; right:0;
      bottom: 0; padding: 10px calc(var(--pad) + env(safe-area-inset-left)) calc(10px + env(safe-area-inset-bottom)) calc(var(--pad) + env(safe-area-inset-right));
      display: grid; gap: var(--gap);
      grid-template-columns: 1fr 1fr 1fr;
      background: color-mix(in srgb, var(--bg) 92%, transparent);
      backdrop-filter: saturate(1.2) blur(8px);
      border-top: 1px solid rgba(127,127,127,.25);
      max-width: 880px; margin-inline: auto;
    }
    .actions.sticky button{
      font-weight:600;
      background:#1472ff; color:#fff; border:none;
    }
    .actions.sticky button#btnClear{ background:#e4e7ec; color:#111; }
    .status-wrap{margin:8px 0}
    pre{
      background:var(--codebg); color:var(--codefg);
      padding:12px; border-radius: var(--radius); min-height: 180px; overflow:auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Liberation Mono", Consolas, monospace;
    }
    .inline-btn{ width:auto; padding:8px 14px; margin-left:8px; border:1px solid #d0d5dd; background:var(--card) }
  </style>
</head>
<body>
  <h1>JS 解密 · 网页端</h1>
  <p class="muted">固定仓库：<b>Mikephie/OtOjs</b>，分支：<b>main</b></p>

  <label>GitHub Token（PAT，勾 <code>repo</code> 权限）</label>
  <input id="token" type="password" placeholder="你的 GitHub PAT" inputmode="latin" autocomplete="off" />

  <div class="grid grid-2">
    <div>
      <label>方式 A：远端链接（自动拉取，无需按钮）</label>
      <input id="srcUrl" placeholder="https://raw.githubusercontent.com/owner/repo/branch/file.js" />
      <p class="muted">输入/粘贴链接后，回车 或 停止输入 0.8s 自动拉取并填入下方输入框。</p>
    </div>
    <div>
      <label>方式 B：本地文件（选择后自动读取）</label>
      <input id="srcFile" type="file" accept=".js,.txt,.json,*/*" />
      <p class="muted">选择文件后会自动读取并填入下方输入框。</p>
    </div>
  </div>

  <label>方式 C：直接粘贴（上方链接/文件也会自动写入这里）</label>
  <textarea id="code" placeholder="// 在此粘贴，或等待上方自动填充"></textarea>

  <div class="status-wrap">
    <p id="wfStatus"></p>
    <p id="status"></p>
  </div>

  <h2 style="display:flex;align-items:center;gap:12px;margin:10px 0 6px">
    output.js
    <button id="btnCopyOut" class="inline-btn">一键复制</button>
  </h2>
  <pre id="out">// 这里会显示输出内容</pre>

  <!-- 粘性操作栏：始终可点 -->
  <div class="actions sticky">
    <button id="btnClear">清空输入</button>
    <button id="btnSubmit">提交 input.js</button>
    <button id="btnRead">读取 output.js</button>
  </div>

  <script src="./app.js"></script>
</body>
</html>